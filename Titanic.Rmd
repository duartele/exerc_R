---
title: "Titanic"
author: "Leandro Duarte"
date: "11/18/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r, echo=FALSE, eval=TRUE}
# Use getwd() para ver se está no diretorio correto
df<-read.csv2("titanic.csv",colClasses = c("factor", "factor","factor","numeric","integer","integer","numeric", "factor","factor")) #Como importei a base

# Usar attach(df) se não quiser ficar digitando df$ em cada variável

```
## Estudo sobre a base Titanic

1. Introdução

O objetivo primordial deste estudo é aplicar os conhecimentos aprendidos em Estatística Computacional com o professor Luís Machado (MECD), apresentando os passos e comandos utilizados nos softwares R e SPSS.

A base de dados escolhida é a Titanic porque se trata de um acidente histórico que até hoje está no imaginário popular e também por ser bastante usada nos estudos iniciais de Machine Learning.

Vale dizer, sua utilização em estudos se deve ao fato dessa base possuir poucas variáveis, mas em quantidade suficiente para aplicar diversas técnicas estatísticas.

O **RMS Titanic** foi um navio luxuoso construído para ser 'inafundável'. Partiu dia 10 de abril de 1912 com 2224 pessoas (passageiros e tripulantes) e o acidente ocorreu dia 15 de abril daquele ano, acarretando em mais de 1500 mortes [(ver Wikipédia)](https://en.wikipedia.org/wiki/Titanic).

2. Primeiras Análises

A base analisada tem `r nrow(df)` observações e `r nrow(df)` variáveis, as quais serão apresentadas a seguir.

    2.1 Dicionário de variáveis

+ **survived**: Sobrevivência (ou não) dos passageiros. Possíveis valores: 0 (morreu) ou 1 (sobreviveu);

+ **pclass**: Classe do Bilhete. Possíveis valores: 1(primeira), 2(segunda) ou 3 (terceira);
`
+ **sex**: Gênero do passageiro. Possíveis valores: female (feminino) ou male(masculino);

+ **age**: Idade em anos. Possíveis valores: Para crianças menores de um ano, a idade pode assumir um valor contínuo (no intervalo  ]0,1[). Para mais velhos que isso, usa-se o valores discretos  {1,2,3...}. Quando tem o valor da forma xx.5 é porque a idade da pessoa foi estimada.

+ **sibsp**: Número de irmãos e/ou esposos a bordo. Possíveis valores: {0,1,2,3...};

+ **parch**: Número de pais e/ou filhos a bordo. Possíveis valores: {0,1,2,3...};

+ **fare**: Valor da tarifa paga. Possíveis valores: ]0,+∞[;

+ **embarked**: Porto de Embarque. Possíveis valores: C (Cherbourg), Q (Queenstown) ou S (Southampton);

+ **death**: Morte (ou não) do passageiro. Possíveis valores: 0 (não morreu) ou 1(morreu). Esta variável será descartada porque foi obtida pela variável **survived**.

Observe o tipo das variáveis e depois os primeiros registros em forma tabular:

```{r, echo=TRUE, eval=TRUE}
str(df)
head(df)
```

Antes de analisarmos as variáveis individualmente (e cruzando-as com a variável respostas), vale observar a tabela resumo que apresenta as frequências das variáveis qualitativas, medidas descrtivas nas variáveis quantitativas e a quantidade de registros faltantes em cada atributo:

```{r}
summary(df)
```

Percebemos pela tabela resumo que cada categoria das variáveis qualitativas possuem ao menos 10% de representantes, o que é bom para formularmos hipóteses iniciais.
Quanto às informações faltantes, a única variável alarmante é a idade (20% dos registros). Como algumas técnicas de modelagem não permitem a utilização de "missings", podemos contornar esse problema de três formas:

1. removendo registros faltantes - quando são poucos;
2. utilizando o valor médio (ou a moda) amostral - quando a variável ainda possa contribuir para explicar a variável resposta;
3. excluíndo a variável do modelo - quando são muitos registros faltantes.

Agora, passemos a analisar cada variável individualmente e com a variável resposta. Para facilitar a apresentação, separaremos as variáveis qualitativas e quantitativas.

    2.2 Variáveis Qualitativas
    2.2.1 Variáveis Qualitativas Nominais
    
**Sex** (female ou male)

```{r, echo=TRUE}
pie(x=table(df$sex), labels=c("Female","Male"), col = c("lightblue", "lightgreen"))
```

Das `r  nrow(df)` observações, temos `r table(df$sex)[1]` mulheres (`r round(table(df$sex)[1]/nrow(df)*100,2)`%) e
`r table(df$sex)[2]` homens (`r round(table(df$sex)[2]/nrow(df)*100,2)`%), sem
valores faltantes, portanto.
No gráfico a seguir, veremos para cada uma dessas categorias o comportamento da variável resposta.


```{r, echo=TRUE}
barplot(table(df$survived,df$sex),legend.text = TRUE)

```

Pela apreciação desse gráfico, percebe-se que as mulheres tiveram mais chances de sobrevivência que os homens, indicando assim que a variável sexo pode ajudar a explicar a sobrevivência de um passageiro.

**Embarked** (C - Cherbourg, Q - Queenstown ou S - Southampton)

```{r, echo=TRUE}
pie(x=table(df$embarked))

```

Percebemos que o Porto de Southampton é o mais frequente. Quanto ao comportamento desta variável em relação a resposta temos:

```{r, echo=TRUE}
barplot(table(df$survived,df$embarked),legend.text = TRUE)

```

2.2.2 Variáveis Qualitativas Ordinais

**Pclass** (1, 2 ou 3)

```{r, echo=TRUE}
barplot(table(df$survived,df$pclass),legend.text = TRUE)
```

Observando o gráfico acima, percebemos que a 3ra classe é a mais frequente. Além disso, temos a sugestão de que quanto pior é a classe menor é a chance de sobreviência de um passageiro.

2.3 Variáveis Quantitativas Discretas

**Sibsp** (Número de irmãos e ou esposos)

```{r, echo=TRUE}
hist(df$sibsp)
```

A maioria dos passageiros embarcou sozinho ou com apenas um(a) espos(a)(ou irmã(o)). Talvez podemos categorizar essa variável em "possui" ou "não possui" irmãos ou esposos.

**Parch** (Número de pais ou filhos a bordo)

```{r, echo=TRUE}
hist(df$parch)
```

Assim como sibsp, a maioria dos passageiros embarcou sozinho ou possuía apenas um ou dois filhos (ou pais).